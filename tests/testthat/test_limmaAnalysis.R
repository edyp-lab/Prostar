context("limma Analysis")

# require(DAPARdata)
# data(Exp1_R2_pept)
# test <- Exp1_R2_pept[170:180]

# 
# 
# test_that("limmaCompleteTest", {
#     
#     
#     
#     m1 <- data.frame(logFC = c(-0.4072, -0.6320, -0.3365, -0.2288,  0.2328, -0.1919, -0.1739, -0.1149, -0.0546, -0.0260, -0.0213),
#                     AveExpr = c(26.5604, 24.5760, 26.3923, 27.6750, 23.1868, 24.9437, 23.0873, 25.5138, 25.4416, 21.2579, 23.2761),
#                     t = c(-5.5200, -5.3059, -5.1281, -3.1218,  1.6307, -1.5052, -1.2793, -0.9782, -0.3823, -0.0879, -0.0827),
#                     P_Value = c(0.0014, 0.0018, 0.0021, 0.0203, 0.1536, 0.1825, 0.2476, 0.3654, 0.7153, 0.9328, 0.9367),
#                     adj_P_Val = c(0.0077, 0.0077, 0.0077, 0.0558, 0.3346, 0.3346, 0.3891, 0.5024, 0.8743, 0.9367, 0.9367),
#                     B = c(-0.5686, -0.7775, -0.9562, -3.3188, -5.3449, -5.5038, -5.7745, -6.0938, -6.5187, -6.5968, -6.5973))
#     rownames(m1) <- c(176,177,178,173,172,174,169,175,170,179,171)
# 
#     m2 <- data.frame(X__Condition1____1____Condition2____1 = c(-0.4072, -0.6320, -0.3365, -0.2288,  0.2328, -0.1919, -0.1739, -0.1149, -0.0546, -0.0260, -0.0213),
#                      X__Condition2____1____Condition1____1 = c(0.4072,  0.6320,  0.3365,  0.2288, -0.2328,  0.1919,  0.1739,  0.1149,  0.0546, 0.0260, 0.0213),
#                      AveExpr = c(26.5604, 24.5760, 26.3923, 27.6750, 23.1868, 24.9437, 23.0873, 25.5138, 25.4416, 21.2579, 23.2761),
#                      F = c(30.4706, 28.1524, 26.2969,  9.7459,  2.6593,  2.2657,  1.6366,  0.9569,  0.1461,  0.0077,  0.0068),
#                      P_Value = c(0.0014, 0.0018, 0.0021, 0.0203, 0.1536, 0.1825, 0.2476, 0.3654, 0.7153, 0.9328, 0.9367),
#                      adj_P_Val = c(0.0077, 0.0077, 0.0077, 0.0558, 0.3346, 0.3346, 0.3891, 0.5024, 0.8743, 0.9367, 0.9367))
#     rownames(m2) <- c(176,177,178,173,172,174,169,175,170,179,171)
#     
#     
#     condition1 <- '10fmol'
#     condition2 <- '5fmol'
#     qData <- Biobase::exprs(test)
#     RepBio <- RepTech <- factor(1:6)
#     conds <- factor(c(rep(condition1, 3), (rep(condition2, 3))))
#     limma1 <- limmaCompleteTest(qData,conds,RepBio, RepTech, Contrast=1)
#     limma2 <- limmaCompleteTest(qData,conds,RepBio, RepTech, Contrast=2)
#     
#     expect_equal(round(limma1,4), m1)
#     expect_equal(round(limma2,4), m2)
# })
# 
# 
# 
